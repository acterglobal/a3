<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The interface for a single operation within a trace."><title>Span in opentelemetry::trace - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-b1a3e7f8283b8434.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="opentelemetry" data-themes="" data-resource-suffix="" data-rustdoc-version="1.77.0-nightly (d5fd09972 2024-01-22)" data-channel="nightly" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-f2adc0d6ca4d09fb.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-48f368f3872407c8.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../opentelemetry/index.html"><img src="https://raw.githubusercontent.com/open-telemetry/opentelemetry-rust/main/assets/logo.svg" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../opentelemetry/index.html"><img src="https://raw.githubusercontent.com/open-telemetry/opentelemetry-rust/main/assets/logo.svg" alt="logo"></a><h2><a href="../../opentelemetry/index.html">opentelemetry</a><span class="version">0.21.0</span></h2></div><h2 class="location"><a href="#">Span</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.add_event_with_timestamp">add_event_with_timestamp</a></li><li><a href="#tymethod.end_with_timestamp">end_with_timestamp</a></li><li><a href="#tymethod.is_recording">is_recording</a></li><li><a href="#tymethod.set_attribute">set_attribute</a></li><li><a href="#tymethod.set_status">set_status</a></li><li><a href="#tymethod.span_context">span_context</a></li><li><a href="#tymethod.update_name">update_name</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.add_event">add_event</a></li><li><a href="#method.end">end</a></li><li><a href="#method.record_error">record_error</a></li><li><a href="#method.set_attributes">set_attributes</a></li></ul><h3><a href="#object-safety">Object Safety</a></h3><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In opentelemetry::trace</a></h2></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../../opentelemetry/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="../index.html">opentelemetry</a>::<wbr><a href="index.html">trace</a>::<wbr><a class="trait" href="#">Span</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/opentelemetry/trace/span.rs.html#50-164">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait Span {
    // Required methods
    fn <a href="#tymethod.add_event_with_timestamp" class="fn">add_event_with_timestamp</a>&lt;T&gt;(
        &amp;mut self,
        name: T,
        timestamp: <a class="struct" href="https://doc.rust-lang.org/nightly/std/time/struct.SystemTime.html" title="struct std::time::SystemTime">SystemTime</a>,
        attributes: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../struct.KeyValue.html" title="struct opentelemetry::KeyValue">KeyValue</a>&gt;
    )
       <span class="where">where T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/alloc/borrow/enum.Cow.html" title="enum alloc::borrow::Cow">Cow</a>&lt;'static, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>&gt;&gt;</span>;
<span class="item-spacer"></span>    fn <a href="#tymethod.span_context" class="fn">span_context</a>(&amp;self) -&gt; &amp;<a class="struct" href="struct.SpanContext.html" title="struct opentelemetry::trace::SpanContext">SpanContext</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.is_recording" class="fn">is_recording</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.set_attribute" class="fn">set_attribute</a>(&amp;mut self, attribute: <a class="struct" href="../struct.KeyValue.html" title="struct opentelemetry::KeyValue">KeyValue</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.set_status" class="fn">set_status</a>(&amp;mut self, status: <a class="enum" href="enum.Status.html" title="enum opentelemetry::trace::Status">Status</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.update_name" class="fn">update_name</a>&lt;T&gt;(&amp;mut self, new_name: T)
       <span class="where">where T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/alloc/borrow/enum.Cow.html" title="enum alloc::borrow::Cow">Cow</a>&lt;'static, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>&gt;&gt;</span>;
<span class="item-spacer"></span>    fn <a href="#tymethod.end_with_timestamp" class="fn">end_with_timestamp</a>(&amp;mut self, timestamp: <a class="struct" href="https://doc.rust-lang.org/nightly/std/time/struct.SystemTime.html" title="struct std::time::SystemTime">SystemTime</a>);

    // Provided methods
    fn <a href="#method.add_event" class="fn">add_event</a>&lt;T&gt;(&amp;mut self, name: T, attributes: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../struct.KeyValue.html" title="struct opentelemetry::KeyValue">KeyValue</a>&gt;)
       <span class="where">where T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/alloc/borrow/enum.Cow.html" title="enum alloc::borrow::Cow">Cow</a>&lt;'static, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>&gt;&gt;</span> { ... }
<span class="item-spacer"></span>    fn <a href="#method.record_error" class="fn">record_error</a>(&amp;mut self, err: &amp;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/error/trait.Error.html" title="trait core::error::Error">Error</a>) { ... }
<span class="item-spacer"></span>    fn <a href="#method.set_attributes" class="fn">set_attributes</a>(&amp;mut self, attributes: impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = <a class="struct" href="../struct.KeyValue.html" title="struct opentelemetry::KeyValue">KeyValue</a>&gt;) { ... }
<span class="item-spacer"></span>    fn <a href="#method.end" class="fn">end</a>(&amp;mut self) { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>The interface for a single operation within a trace.</p>
<p>Spans can be nested to form a trace tree. Each trace contains a root span,
which typically describes the entire operation and, optionally, one or more
sub-spans for its sub-operations.</p>
<p>The span <code>name</code> concisely identifies the work represented by the span, for
example, an RPC method name, a function name, or the name of a subtask or
stage within a larger computation. The span name should be the most general
string that identifies a (statistically) interesting class of spans, rather
than individual span instances while still being human-readable. That is,
<code>&quot;get_user&quot;</code> is a reasonable name, while <code>&quot;get_user/314159&quot;</code>, where <code>&quot;314159&quot;</code> is
a user ID, is not a good name due to its high cardinality. <em>Generality</em>
should be prioritized over <em>human-readability</em>.</p>
<p>For example, here are potential span names for an endpoint that gets a
hypothetical account information:</p>
<div><table><thead><tr><th>Span Name</th><th>Guidance</th></tr></thead><tbody>
<tr><td><code>get</code></td><td>Too general</td></tr>
<tr><td><code>get_account/42</code></td><td>Too specific</td></tr>
<tr><td><code>get_account</code></td><td>Good, and account_id=42 would make a nice Span attribute</td></tr>
<tr><td><code>get_account/{accountId}</code></td><td>Also good (using the “HTTP route”)</td></tr>
</tbody></table>
</div>
<p>The span’s start and end timestamps reflect the elapsed real time of the
operation.</p>
<p>For example, if a span represents a request-response cycle (e.g. HTTP or an
RPC), the span should have a start time that corresponds to the start time
of the first sub-operation, and an end time of when the final sub-operation
is complete. This includes:</p>
<ul>
<li>receiving the data from the request</li>
<li>parsing of the data (e.g. from a binary or json format)</li>
<li>any middleware or additional processing logic</li>
<li>business logic</li>
<li>construction of the response</li>
<li>sending of the response</li>
</ul>
<p>Child spans (or in some cases events) may be created to represent
sub-operations which require more detailed observability. Child spans should
measure the timing of the respective sub-operation, and may add additional
attributes.</p>
</div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.add_event_with_timestamp" class="method"><a class="src rightside" href="../../src/opentelemetry/trace/span.rs.html#87-93">source</a><h4 class="code-header">fn <a href="#tymethod.add_event_with_timestamp" class="fn">add_event_with_timestamp</a>&lt;T&gt;(
    &amp;mut self,
    name: T,
    timestamp: <a class="struct" href="https://doc.rust-lang.org/nightly/std/time/struct.SystemTime.html" title="struct std::time::SystemTime">SystemTime</a>,
    attributes: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../struct.KeyValue.html" title="struct opentelemetry::KeyValue">KeyValue</a>&gt;
)<div class="where">where
    T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/alloc/borrow/enum.Cow.html" title="enum alloc::borrow::Cow">Cow</a>&lt;'static, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>&gt;&gt;,</div></h4></section></summary><div class="docblock"><p>Record an event with a timestamp in the context this span.</p>
<p>Note that the OpenTelemetry project documents certain “<a href="https://github.com/open-telemetry/opentelemetry-specification/blob/v1.9.0/specification/trace/semantic_conventions/README.md">standard
attributes</a>” that have prescribed semantic meanings and are available via
the <a href="https://docs.rs/opentelemetry-semantic-conventions">opentelemetry_semantic_conventions</a> crate.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.span_context" class="method"><a class="src rightside" href="../../src/opentelemetry/trace/span.rs.html#96">source</a><h4 class="code-header">fn <a href="#tymethod.span_context" class="fn">span_context</a>(&amp;self) -&gt; &amp;<a class="struct" href="struct.SpanContext.html" title="struct opentelemetry::trace::SpanContext">SpanContext</a></h4></section></summary><div class="docblock"><p>A reference to the <a href="struct.SpanContext.html" title="struct opentelemetry::trace::SpanContext"><code>SpanContext</code></a> for this span.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.is_recording" class="method"><a class="src rightside" href="../../src/opentelemetry/trace/span.rs.html#108">source</a><h4 class="code-header">fn <a href="#tymethod.is_recording" class="fn">is_recording</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Returns <code>true</code> if this span is recording information.</p>
<p>Spans will not be recording information after they have ended.</p>
<p>This flag may be <code>true</code> despite the entire trace being sampled out. This
allows recording and processing of information about the individual
spans without sending it to the backend. An example of this scenario may
be recording and processing of all incoming requests for the processing
and building of SLA/SLO latency charts while sending only a subset -
sampled spans - to the backend.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.set_attribute" class="method"><a class="src rightside" href="../../src/opentelemetry/trace/span.rs.html#122">source</a><h4 class="code-header">fn <a href="#tymethod.set_attribute" class="fn">set_attribute</a>(&amp;mut self, attribute: <a class="struct" href="../struct.KeyValue.html" title="struct opentelemetry::KeyValue">KeyValue</a>)</h4></section></summary><div class="docblock"><p>Set an attribute of this span.</p>
<p>Setting an attribute with the same key as an existing attribute
results in both being stored as attribute, without any de-duplication
performed.</p>
<p>Note that the OpenTelemetry project documents certain “<a href="https://github.com/open-telemetry/opentelemetry-specification/blob/v1.9.0/specification/trace/semantic_conventions/README.md">standard
attributes</a>” that have prescribed semantic meanings and are available via
the <a href="https://docs.rs/opentelemetry-semantic-conventions">opentelemetry_semantic_conventions</a> crate.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.set_status" class="method"><a class="src rightside" href="../../src/opentelemetry/trace/span.rs.html#147">source</a><h4 class="code-header">fn <a href="#tymethod.set_status" class="fn">set_status</a>(&amp;mut self, status: <a class="enum" href="enum.Status.html" title="enum opentelemetry::trace::Status">Status</a>)</h4></section></summary><div class="docblock"><p>Sets the status of this <code>Span</code>.</p>
<p>If used, this will override the default span status, which is <a href="enum.Status.html#variant.Unset" title="variant opentelemetry::trace::Status::Unset"><code>Status::Unset</code></a>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.update_name" class="method"><a class="src rightside" href="../../src/opentelemetry/trace/span.rs.html#153-155">source</a><h4 class="code-header">fn <a href="#tymethod.update_name" class="fn">update_name</a>&lt;T&gt;(&amp;mut self, new_name: T)<div class="where">where
    T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/alloc/borrow/enum.Cow.html" title="enum alloc::borrow::Cow">Cow</a>&lt;'static, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>&gt;&gt;,</div></h4></section></summary><div class="docblock"><p>Updates the span’s name.</p>
<p>After this update, any sampling behavior based on the name will depend on
the implementation.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.end_with_timestamp" class="method"><a class="src rightside" href="../../src/opentelemetry/trace/span.rs.html#163">source</a><h4 class="code-header">fn <a href="#tymethod.end_with_timestamp" class="fn">end_with_timestamp</a>(&amp;mut self, timestamp: <a class="struct" href="https://doc.rust-lang.org/nightly/std/time/struct.SystemTime.html" title="struct std::time::SystemTime">SystemTime</a>)</h4></section></summary><div class="docblock"><p>Signals that the operation described by this span ended at the given time.</p>
</div></details></div><h2 id="provided-methods" class="section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.add_event" class="method"><a class="src rightside" href="../../src/opentelemetry/trace/span.rs.html#59-64">source</a><h4 class="code-header">fn <a href="#method.add_event" class="fn">add_event</a>&lt;T&gt;(&amp;mut self, name: T, attributes: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../struct.KeyValue.html" title="struct opentelemetry::KeyValue">KeyValue</a>&gt;)<div class="where">where
    T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/alloc/borrow/enum.Cow.html" title="enum alloc::borrow::Cow">Cow</a>&lt;'static, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.str.html">str</a>&gt;&gt;,</div></h4></section></summary><div class="docblock"><p>Record an event in the context this span.</p>
<p>Note that the OpenTelemetry project documents certain “<a href="https://github.com/open-telemetry/opentelemetry-specification/blob/v1.9.0/specification/trace/semantic_conventions/README.md">standard
attributes</a>” that have prescribed semantic meanings and are available via
the <a href="https://docs.rs/opentelemetry-semantic-conventions">opentelemetry_semantic_conventions</a> crate.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.record_error" class="method"><a class="src rightside" href="../../src/opentelemetry/trace/span.rs.html#72-77">source</a><h4 class="code-header">fn <a href="#method.record_error" class="fn">record_error</a>(&amp;mut self, err: &amp;dyn <a class="trait" href="https://doc.rust-lang.org/nightly/core/error/trait.Error.html" title="trait core::error::Error">Error</a>)</h4></section></summary><div class="docblock"><p>Record an error as an event for this span.</p>
<p>An additional call to <a href="trait.Span.html#tymethod.set_status" title="method opentelemetry::trace::Span::set_status">Span::set_status</a> is required if the status of the
span should be set to error, as this method does not change the span status.</p>
<p>If this span is not being recorded then this method does nothing.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.set_attributes" class="method"><a class="src rightside" href="../../src/opentelemetry/trace/span.rs.html#136-142">source</a><h4 class="code-header">fn <a href="#method.set_attributes" class="fn">set_attributes</a>(&amp;mut self, attributes: impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = <a class="struct" href="../struct.KeyValue.html" title="struct opentelemetry::KeyValue">KeyValue</a>&gt;)</h4></section></summary><div class="docblock"><p>Set multiple attributes of this span.</p>
<p>Setting an attribute with the same key as an existing attribute
results in both being stored as attribute, without any de-duplication
performed.</p>
<p>Note that the OpenTelemetry project documents certain “<a href="https://github.com/open-telemetry/opentelemetry-specification/blob/v1.9.0/specification/trace/semantic_conventions/README.md">standard
attributes</a>” that have prescribed semantic meanings and are available via
the <a href="https://docs.rs/opentelemetry-semantic-conventions">opentelemetry_semantic_conventions</a> crate.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.end" class="method"><a class="src rightside" href="../../src/opentelemetry/trace/span.rs.html#158-160">source</a><h4 class="code-header">fn <a href="#method.end" class="fn">end</a>(&amp;mut self)</h4></section></summary><div class="docblock"><p>Signals that the operation described by this span has now ended.</p>
</div></details></div><h2 id="object-safety" class="section-header">Object Safety<a href="#object-safety" class="anchor">§</a></h2><div class="object-safety-info">This trait is <b>not</b> <a href="https://doc.rust-lang.org/nightly/reference/items/traits.html#object-safety">object safe</a>.</div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-Span-for-BoxedSpan" class="impl"><a class="src rightside" href="../../src/opentelemetry/global/trace.rs.html#167-223">source</a><a href="#impl-Span-for-BoxedSpan" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.Span.html" title="trait opentelemetry::trace::Span">Span</a> for <a class="struct" href="../global/struct.BoxedSpan.html" title="struct opentelemetry::global::BoxedSpan">BoxedSpan</a></h3></section><section id="impl-Span-for-NoopSpan" class="impl"><a class="src rightside" href="../../src/opentelemetry/trace/noop.rs.html#48-101">source</a><a href="#impl-Span-for-NoopSpan" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.Span.html" title="trait opentelemetry::trace::Span">Span</a> for <a class="struct" href="noop/struct.NoopSpan.html" title="struct opentelemetry::trace::noop::NoopSpan">NoopSpan</a></h3></section></div><script src="../../trait.impl/opentelemetry/trace/span/trait.Span.js" async></script></section></div></main></body></html>